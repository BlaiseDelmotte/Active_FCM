!!====================================================================
!!
!!
!!====================================================================

subroutine MESHING

!!====================================================================
!!
!!
!!====================================================================

use dns_dim
use GEOMETRIC

implicit none


!---------------------------------------------------------------------
!- Local arrays
!---------------------------------------------------------------------
integer :: I, J, K

real(kind=8) :: DX, DY, DZ
!---------------------------------------------------------------------


!!====================================================================
!! 1. COMPUTATIONNAL GRID (physical space)
!!====================================================================
!- Space step
DX = LXMAX / real(NX)
DY = LYMAX / real(NY)
DZ = LZMAX / real(NZ)

!!--------------------------------------------------------------------
!! 1.1. x-direction
!!--------------------------------------------------------------------
!! I=     1       2             NX-1     NX
!!        !-------!---- .... ----!-------!
!! X=     0      DX            L-2DX    L-DX
!!--------------------------------------------------------------------
do I = ISTART(1), IEND(1)
 XMESH(I) = (I-1)*DX
end do


!!--------------------------------------------------------------------
!! 1.2. y-direction
!!--------------------------------------------------------------------
!! J=     1       2             NY-1     NY
!!        !-------!---- .... ----!-------!
!! Y=     0      DY            L-2DY    L-DY
!!--------------------------------------------------------------------
do J = ISTART(2), IEND(2)
 YMESH(J) = DY*(J-1)
end do


!!--------------------------------------------------------------------
!! 1.3. z-direction
!!--------------------------------------------------------------------
!!
!! K=     1       2             NZ-1     NZ
!!        !-------!---- .... ----!-------!
!! Z=     0      DZ            L-2DZ    L-DZ
!!
!!--------------------------------------------------------------------
!! In physical space the slab are oriented along z
!!--------------------------------------------------------------------
do K = ISTART(3), IEND(3)
 ZMESH(K) = DZ*(K-1)
end do




!!====================================================================
!! 2. COMPUTATIONNAL GRID (physical space)
!!====================================================================
!- Space step
DX = LXMAX / real(NXI)
DY = LYMAX / real(NYI)
DZ = LZMAX / real(NZI)

!!--------------------------------------------------------------------
!! 1.1. x-direction
!!--------------------------------------------------------------------
!! I=     1       2             NX-1     NX
!!        !-------!---- .... ----!-------!
!! X=     0      DX            L-2DX    L-DX
!!--------------------------------------------------------------------
do I = ISTARTI(1), IENDI(1)
 XMESHI(I) = (I-1)*DX
end do


!!--------------------------------------------------------------------
!! 1.2. y-direction
!!--------------------------------------------------------------------
!! J=     1       2             NY-1     NY
!!        !-------!---- .... ----!-------!
!! Y=     0      DY            L-2DY    L-DY
!!--------------------------------------------------------------------
do J = ISTARTI(2), IENDI(2)
 YMESHI(J) = DY*(J-1)
end do


!!--------------------------------------------------------------------
!! 1.3. z-direction
!!--------------------------------------------------------------------
!!
!! K=     1       2             NZ-1     NZ
!!        !-------!---- .... ----!-------!
!! Z=     0      DZ            L-2DZ    L-DZ
!!
!!--------------------------------------------------------------------
!! In physical space the slab are oriented along z
!!--------------------------------------------------------------------
do K = ISTARTI(3), IENDI(3)
 ZMESHI(K) = DZ*(K-1)
end do




if(MYID==0) write(*,*)'Mesh construction --> OK'



end subroutine MESHING
